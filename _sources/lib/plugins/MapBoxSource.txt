
.. currentmodule:: gxp.plugins

:class:`gxp.plugins.MapBoxSource`
================================================================================


.. cssclass:: meta


Extends
    * `Ext.util.Observable <http://extjs.com/deploy/dev/docs/?class=Ext.util.Observable>`_
    
    * :class:`gxp.plugins.LayerSource`





ptype
    ``gxp_mapboxsource``



.. class:: MapBoxSource(config)

  Plugin for using MapBox layers with :class:`gxp.Viewer` instances.
  Freely available for commercial and non-commercial use according to the
  MapBox terms of service: http://mapbox.com/tos

  Available layer names:
   * blue-marble-topo-bathy-jan
   * blue-marble-topo-bathy-jul
   * blue-marble-topo-jan
   * blue-marble-topo-jul
   * control-room
   * geography-class
   * natural-earth-hypso
   * natural-earth-hypso-bathy
   * natural-earth-1
   * natural-earth-2
   * world-dark
   * world-light
   * world-print




Example Use
-----------

The configuration in the ``sources`` property of the :class:`gxp.Viewer` is
straightforward:

.. code-block:: javascript

  mapbox: {
      ptype: "gxp_mapboxsource"
  }

A typical configuration for a layer from this source (in the ``layers``
array of the viewer's ``map`` config option would look like this:

.. code-block:: javascript

  {
      source: "mapbox",
      name: "blue-marble-topo-bathy-jan"
  }


    


Config Options
--------------

Configuration properties in addition to
those listed for `Ext.util.Observable <http://extjs.com/deploy/dev/docs/?class=Ext.util.Observable>`_.


.. describe:: title

    ``String``
    A descriptive title for this layer source (i18n).




Public Properties
-----------------

Public properties in addition to those
listed for `Ext.util.Observable <http://extjs.com/deploy/dev/docs/?class=Ext.util.Observable>`_.


.. attribute:: MapBoxSource.store

    ``GeoExt.data.LayerStore``. Will contain records with name field values
    matching MapBox layer names.

.. attribute:: MapBoxSource.title

    ``String``
    A descriptive title for this layer source.




Public Methods
--------------

Public methods in addition to those
listed for `Ext.util.Observable <http://extjs.com/deploy/dev/docs/?class=Ext.util.Observable>`_.


.. method:: MapBoxSource.createLayerRecord

    :arg config:  ``Object``  The application config for this layer.
    :returns: ``GeoExt.data.LayerRecord``
    
    Create a layer record given the config.

.. method:: MapBoxSource.createStore

    Creates a store of layer records.  Fires "ready" when store is loaded.

.. method:: MapBoxSource.getConfigForRecord

    :arg record: :class:`GeoExt.data.LayerRecord`
    :returns: ``Object``
    
    Create a config object that can be used to recreate the given record.

.. method:: MapBoxSource.getProjection

    :arg layerRecord: ``GeoExt.data.LayerRecord`` a record from this
        source's store
    :returns: ``OpenLayers.Projection`` A suitable projection for the
        ``layerRecord``. If the layer is available in the map projection,
        the map projection will be returned. Otherwise an equal projection,
        or null if none is available.
    
    Get the projection that the source will use for the layer created in
    ``createLayerRecord``. If the layer is not available in a projection
    that fits the map projection, null will be returned.

.. method:: MapBoxSource.init

    :arg target: ``Object`` The object initializing this plugin.
    
    Calls :meth:`createStore` with a callback that fires the 'ready' event.




Events
------

Events in addition to those
listed for `Ext.util.Observable <http://extjs.com/deploy/dev/docs/?class=Ext.util.Observable>`_.


.. describe:: failure

    Fires if the layer source fails to load.

.. describe:: ready

    Fires when the layer source is ready for action.



