<!DOCTYPE html>
<html debug="true">
  <head>
    <script src="http://extjs.cachefly.net/ext-3.4.0/adapter/ext/ext-base.js"></script>
    <script src="http://extjs.cachefly.net/ext-3.4.0/ext-all-debug.js"></script>
    <script type="text/javascript" src="../../../../externals/openlayers/lib/OpenLayers.js"></script>
    <script type="text/javascript" src="../../../../externals/geoext/lib/GeoExt.js"></script>
    <script type="text/javascript" src="../../../../src/script/loader.js"></script>

    <script type="text/javascript">
       
        function test_FilterField(t) {
            t.plan(1);
            
            var instance = new gxp.form.FilterField();
            
            t.ok(instance instanceof gxp.form.FilterField, "Instance created successfully");
            
            instance.destroy();
        }

        function test_setFilter(t) {
            t.plan(7);
            var filter = new OpenLayers.Filter.Comparison({
                type: OpenLayers.Filter.Comparison.EQUAL_TO,
                property: "STATE_NAME",
                value: "Montana"
            });

            var filter2 = new OpenLayers.Filter.Comparison({
                type: OpenLayers.Filter.Comparison.BETWEEN,
                property: "PERSONS",
                lowerBoundary: 10,
                upperBoundary: 50
            });

            var fb = new gxp.form.FilterField({
                filter: filter,
                attributes: new GeoExt.data.AttributeStore({
                    url: "../../../../examples/data/describe_feature_type.xml",
                    ignore: {name: "the_geom"}
                })
            });
            var idx;
            idx = fb.items.findIndex('name', 'property');
            t.eq(fb.items.get(idx).getValue(), filter.property, "Combo with property name set correctly");
            idx = fb.items.findIndex('name', 'type');
            t.eq(fb.items.get(idx).getValue(), filter.type, "Combo with filter type set correctly");
            idx = fb.items.findIndex('name', 'value');
            t.eq(fb.items.get(idx).getValue(), filter.value, "Field with filter value set correctly");
            fb.setFilter(filter2);
            idx = fb.items.findIndex('name', 'property');
            t.eq(fb.items.get(idx).getValue(), filter2.property, "Combo with property name set correctly");
            idx = fb.items.findIndex('name', 'type');
            t.eq(fb.items.get(idx).getValue(), filter2.type, "Combo with filter type set correctly");
            idx = fb.items.findIndex('name', 'lowerBoundary');
            t.eq(fb.items.get(idx).getValue(), filter2.lowerBoundary, "Field with lower boundary set correctly");
            idx = fb.items.findIndex('name', 'upperBoundary');
            t.eq(fb.items.get(idx).getValue(), filter2.upperBoundary, "Field with upper boundary set correctly");
            fb.destroy();
        }

    </script>
  </head>
  <body>
  </body>
</html>
